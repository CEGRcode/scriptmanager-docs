"use strict";(self.webpackChunkscriptmanager_docs=self.webpackChunkscriptmanager_docs||[]).push([[98],{7712:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>d,contentTitle:()=>r,default:()=>y,frontMatter:()=>p,metadata:()=>s,toc:()=>g});var n=t(8168),i=(t(6540),t(5680)),l=t(3554),o=t.n(l);const p={id:"dna-shape-bed",title:"DNA Shape from BED File",sidebar_label:"DNA Shape from BED"},r=void 0,s={unversionedId:"Tools/sequence-analysis/dna-shape-bed",id:"Tools/sequence-analysis/dna-shape-bed",title:"DNA Shape from BED File",description:"dna-shape-bed",source:"@site/docs/Tools/sequence-analysis/dna-shape-bed.md",sourceDirName:"Tools/sequence-analysis",slug:"/Tools/sequence-analysis/dna-shape-bed",permalink:"/scriptmanager-docs/docs/Tools/sequence-analysis/dna-shape-bed",draft:!1,tags:[],version:"current",lastUpdatedBy:"Olivia Wen-Mei Lang",lastUpdatedAt:1727377471,formattedLastUpdatedAt:"Sep 26, 2024",frontMatter:{id:"dna-shape-bed",title:"DNA Shape from BED File",sidebar_label:"DNA Shape from BED"},sidebar:"toolSidebar",previous:{title:"Sequence Analysis",permalink:"/scriptmanager-docs/docs/Tools/sequence-analysis/"},next:{title:"DNA Shape from FASTA",permalink:"/scriptmanager-docs/docs/Tools/sequence-analysis/dna-shape-fasta"}},d={},g=[{value:"What do these shape options mean?",id:"what-do-these-shape-options-mean",level:2},{value:"File inputs (BED &amp; FASTA)",id:"file-inputs-bed--fasta",level:2},{value:"File Options",id:"file-options",level:2},{value:"Output file (CDT/TAB)",id:"output-file-cdttab",level:2},{value:"Command Line Interface",id:"command-line-interface",level:2},{value:"Positional Input",id:"positional-input",level:3},{value:"Output Options",id:"output-options",level:3},{value:"Strand Options",id:"strand-options",level:3},{value:"Shape Options",id:"shape-options",level:3}],m={toc:g},u="wrapper";function y(e){let{components:a,...l}=e;return(0,i.yg)(u,(0,n.A)({},m,l,{components:a,mdxType:"MDXLayout"}),(0,i.yg)("p",null,(0,i.yg)("img",{alt:"dna-shape-bed",src:t(5227).A,width:"103",height:"103"})),(0,i.yg)("p",null,"Calculate intrinsic DNA shape parameters given BED file and Genome FASTA file. Based on Roh's lab DNAshape server data."),(0,i.yg)("p",null,"Based on the findings from the Rohs lab ",(0,i.yg)("a",{parentName:"p",href:"https://pubmed.ncbi.nlm.nih.gov/23703209/"},"(Zhou et al, 2013)"),", a sliding window approach using a 5bp wide window is a strong predictor of local DNA shape. Using this approach, we can predict 4 kinds of DNA shape:"),(0,i.yg)("ol",null,(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"minor groove width")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"propeller twist")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"helix twist")),(0,i.yg)("li",{parentName:"ol"},(0,i.yg)("strong",{parentName:"li"},"roll"))),(0,i.yg)("img",{src:t(422).A,style:{width:"70%"}}),(0,i.yg)("p",null,"This script takes in a series of nucleotide sequences from a BED file and determines the average shape score(s) across the bp positions."),(0,i.yg)("h2",{id:"what-do-these-shape-options-mean"},"What do these shape options mean?"),(0,i.yg)("p",null,"Below is a video introducing some of the shape measurements that we are trying to capture with these calculations."),(0,i.yg)(o(),{playing:!0,controls:!0,url:"https://www.youtube.com/watch?v=JeQLzRhU--U",mdxType:"ReactPlayer"}),(0,i.yg)("br",null),(0,i.yg)("admonition",{type:"info"},(0,i.yg)("p",{parentName:"admonition"},(0,i.yg)("a",{parentName:"p",href:"https://pubmed.ncbi.nlm.nih.gov/29563167/"},"Read more on how DNA shape was used in the analysis of comparing TF-binding ",(0,i.yg)("em",{parentName:"a"},"in-vivo")," vs ",(0,i.yg)("em",{parentName:"a"},"in-vitro")," (Rossi et al, 2018)."))),(0,i.yg)("h2",{id:"file-inputs-bed--fasta"},"File inputs (BED & FASTA)"),(0,i.yg)("p",null,"The sequence for each input BED-specified coordinates in the FASTA file has a shape score series pattern. Because the shape score is a series corresponding to the bp position, the BED records in the input should be positionally linked to some feature and of the same length."),(0,i.yg)("p",null,"When using the GUI, make sure your input is properly formatted and uses the appropriate BED (",(0,i.yg)("inlineCode",{parentName:"p"},".bed")," or ",(0,i.yg)("inlineCode",{parentName:"p"},".bed.gz"),") and FASTA (",(0,i.yg)("inlineCode",{parentName:"p"},".fa")," / ",(0,i.yg)("inlineCode",{parentName:"p"},".fa.gz")," / ",(0,i.yg)("inlineCode",{parentName:"p"},".fasta")," / ",(0,i.yg)("inlineCode",{parentName:"p"},"..."),") extensions."),(0,i.yg)("h2",{id:"file-options"},"File Options"),(0,i.yg)("p",null,"The 'Force Strandedness' options ensures that the DNA strand orientation during the analysis is considered."),(0,i.yg)("h2",{id:"output-file-cdttab"},"Output file (CDT/TAB)"),(0,i.yg)("p",null,"The average composites of the CDT output will be displayed in the GUI output window:"),(0,i.yg)("div",{class:"tutorial-img-flow-container"},(0,i.yg)("img",{src:t(8386).A,style:{width:"50%"}}),(0,i.yg)("img",{src:t(9483).A,style:{width:"50%"}})),(0,i.yg)("p",null,"There should be a ",(0,i.yg)("a",{parentName:"p",href:"/docs/Guides/Getting-Started/file-formats#cdt"},"CDT file"),"/Composite file output for each shape aspect selected based on the input filename and with a suffix distinguishing each selected shape style (",(0,i.yg)("inlineCode",{parentName:"p"},"_HelT.cdt"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"_MGW.cdt"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"_PropT.cdt"),", and ",(0,i.yg)("inlineCode",{parentName:"p"},"_Roll.cdt"),")."),(0,i.yg)("p",null,"For example, in the command-line execution, an ",(0,i.yg)("inlineCode",{parentName:"p"},"-o myoutput")," argument can be provided and the resulting files should be called ",(0,i.yg)("inlineCode",{parentName:"p"},"myoutput_MGW.cdt"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"myoutput_PTwist.cdt"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"myoutput_HTwist.cdt"),", or ",(0,i.yg)("inlineCode",{parentName:"p"},"myoutput_Roll.cdt")," according to the shapes selected (or with ",(0,i.yg)("inlineCode",{parentName:"p"},".out")," if composite is selected)."),(0,i.yg)("admonition",{type:"tip"},(0,i.yg)("p",{parentName:"admonition"},"The output matrix files use the same format as the output from ",(0,i.yg)("a",{parentName:"p",href:"/docs/Tools/read-analysis/tag-pileup"},"Tag Pileup")," (can visualize with Figure Generation's ",(0,i.yg)("a",{parentName:"p",href:"/docs/Tools/figure-generation/heatmap"},"heatmap")," and ",(0,i.yg)("a",{parentName:"p",href:"/docs/Tools/figure-generation/composite-plot"},"composite")," tools).")),(0,i.yg)("h2",{id:"command-line-interface"},"Command Line Interface"),(0,i.yg)("p",null,"Usage:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-bash"},"java -jar ScriptManager.jar sequence-analysis dna-shape-bed [-afghlprV]\n[--avg-composite] [-o=<outputBasename>] <genomeFile> <bedFile>\n")),(0,i.yg)("p",null,"Based on Roh's lab DNAshape server data.\nNotes: Sequences with Ns are thrown out."),(0,i.yg)("h3",{id:"positional-input"},"Positional Input"),(0,i.yg)("p",null,"Expects a ",(0,i.yg)("a",{parentName:"p",href:"/docs/Guides/Getting-Started/file-formats#fasta"},"FASTA")," formatted file with many sequences to stack up with each other (like ",(0,i.yg)("a",{parentName:"p",href:"/docs/Tools/sequence-analysis/fasta-extract"},"fasta-extract tool")," output)."),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"Option"),(0,i.yg)("th",{parentName:"tr",align:null},"Description"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"<genomeFile>")),(0,i.yg)("td",{parentName:"tr",align:null},"reference genome FASTA file")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"<bedFile>")),(0,i.yg)("td",{parentName:"tr",align:null},"the BED file of sequences to extract")))),(0,i.yg)("h3",{id:"output-options"},"Output Options"),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"Option"),(0,i.yg)("th",{parentName:"tr",align:null},"Description"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"-o, --output=<outputBasename>")),(0,i.yg)("td",{parentName:"tr",align:null},"Specify output basename (files for each shape indicated will share this base)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"-z, --gzip")),(0,i.yg)("td",{parentName:"tr",align:null},"gzip output (default=false)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"--avg-composite")),(0,i.yg)("td",{parentName:"tr",align:null},"Save average composite")))),(0,i.yg)("h3",{id:"strand-options"},"Strand Options"),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"Option"),(0,i.yg)("th",{parentName:"tr",align:null},"Description"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"-f, --force")),(0,i.yg)("td",{parentName:"tr",align:null},"force-strandedness (default)")))),(0,i.yg)("h3",{id:"shape-options"},"Shape Options"),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"Option"),(0,i.yg)("th",{parentName:"tr",align:null},"Description"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"-g, --groove")),(0,i.yg)("td",{parentName:"tr",align:null},"output minor groove width")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"-r, --roll")),(0,i.yg)("td",{parentName:"tr",align:null},"output roll")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"-p, --propeller")),(0,i.yg)("td",{parentName:"tr",align:null},"output propeller twist")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"-l, --helical")),(0,i.yg)("td",{parentName:"tr",align:null},"output helical twist")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"-a, --all")),(0,i.yg)("td",{parentName:"tr",align:null},"output groove, roll, propeller twist, and helical twist, equivalent to ",(0,i.yg)("inlineCode",{parentName:"td"},"-grpl"),".")))),(0,i.yg)("p",null,"For each shape option to calculate indicated by the command, a ",(0,i.yg)("a",{parentName:"p",href:"/docs/Guides/Getting-Started/file-formats#cdt"},"CDT file")," will be generated with an extension indicating the shape  type calculated."),(0,i.yg)("p",null,"If the ",(0,i.yg)("em",{parentName:"p"},"groove")," information is indicated in the command to be used for the output, a file called ",(0,i.yg)("inlineCode",{parentName:"p"},"<outputBasename>_MGW.cdt")," will be generated.\nSimilarly for ",(0,i.yg)("em",{parentName:"p"},"propeller"),", ",(0,i.yg)("em",{parentName:"p"},"helical"),", and ",(0,i.yg)("em",{parentName:"p"},"roll"),", the output matrix ",(0,i.yg)("a",{parentName:"p",href:"/docs/Guides/Getting-Started/file-formats#cdt"},"CDT files")," will be named with the suffixes ",(0,i.yg)("inlineCode",{parentName:"p"},"_PTwist.cdt"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"_HTwist.cdt"),", and ",(0,i.yg)("inlineCode",{parentName:"p"},"_Roll.cdt"),", respectively."))}y.isMDXComponent=!0},8386:(e,a,t)=>{t.d(a,{A:()=>n});const n=t.p+"assets/images/DNAShapeBED_Chart-Roll-75a006ac106a428e7c87e40cfa35b0ac.png"},9483:(e,a,t)=>{t.d(a,{A:()=>n});const n=t.p+"assets/images/DNAShapeBED_Statistics-Roll-b7a3aa9f218435dcb72dffa182440d09.png"},422:(e,a,t)=>{t.d(a,{A:()=>n});const n=t.p+"assets/images/DNAShapefromBEDWindow-d9dbb6d4316b84ec00903844042d7d46.png"},5227:(e,a,t)=>{t.d(a,{A:()=>n});const n=t.p+"assets/images/DNAShapefromBED_square-4e9d2206e7e1d3afad6f783e338aff1f.svg"}}]);