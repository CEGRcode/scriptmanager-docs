---
id: genomic-features-tutorial
title: "Genomic Features Tutorial"
sidebar_label: "Genomic Features Tutorial"
---


<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />

_Generating 3 basic sequence-specific ChIP-exo plots: composite, heatmap, and four-color plots_

**Goal:** This tutorial provides a guide to generating 2 basic plots (Composite plot and Heatmap) using the ScriptManager platform and the data generated by the Yeast Epigenome project.

## Download ScriptManager (v0.14):
The current version of ScriptManager is available for download **[here][github-v14]**. Make sure you have [Java installed][java-install].

The file ‘ScriptManager-v0.14.jar’ should be placed someplace locally accessible. For example on Mac OS on the Desktop (Permissions will need to be accepted) or someplace in your home directory (i.e. Macintosh HD/Users/userID/ScriptManager)

## Download the yeast reference genome (sacCer3):

+ You need the reference genome FASTA to complete this exercise.
  + [Reference Yeast Genome(sacCer3_cegr)][saccer3cegr-fasta]


## Download Reb1 sample ChIP-exo peak coordinate information:

+ You need also need the Reb1 peak coordinates to complete this exercise.
  + [Sample BED file for Reb1][testdata-reb1-bed]

## Generate the Four-color Plot
### 1. Generate the FASTA sequence input

+ Navigate to __DNA Sequence Analysis__ -> [__FASTA from BED__][fasta-extract] to create the input for generating a Four Color plot.

<div class="tutorial-img-flow-container">
  <img src={require('./img/maingui-extractfasta.png').default} style={{width:60+'%',}} />
</div>


+ Load the FASTA file containing the Genome FASTA and the appropriate BED file for sequence FASTA generation.
  + A \*.fai file will be generated for the genome file the first time it is used. If the Genome FASTA file is NOT in proper FASTA format the script will fail
  + For sequence-specific factors, a window of ~30 bp is appropriate relative to the motif midpoint. (Go back to ExpandBed to create such a file)

<div class="tutorial-img-flow-container">
  <img src={require('./img/gui-extractfasta.png').default} style={{width:60+'%',}} />
  <i class="fa fa-arrow-right fa-lg"></i>
  <img src={require('./img/gui-extractfasta-complete.png').default} style={{width:40+'%',}}/>
</div>


### 2. Generate the Four color sequence image
+ Navigate to __Figure Generation__ -> [__Four Color Plot__][four-color] to generate the plot once you have generated the FASTA file of the sequences within the BED regions.

<div class="tutorial-img-flow-container">
  <img src={require('./img/maingui-fourcolor.png').default} style={{width:60+'%',}} />
</div>

+ Load the FASTA file containing the FASTA sequences.
+ Tah dah! You've made the third and final figure of this tutorial! It's kind of tall but you can resize it in your favorite image editing software.

<div class="tutorial-img-flow-container">
  <img src={require('./img/gui-fourcolor.png').default} style={{width:60+'%',}} />
  <i class="fa fa-arrow-right fa-lg"></i>
  <img src={require('./img/fourcolor.png').default} style={{width:2+'%',border:'1px solid'}}/>
</div>



[open-sm]:/../static/figs-ex-chipexo/open-sm.png
[gui-expandbed]:/../static/figs-ex-chipexo/gui-expandbed.png

[testdata-reb1-bed]:https://github.com/CEGRcode/2018-Rossi_GenomeResearch/blob/master/Fig1_Reb1/A.Reb1_Rhee_primary_sites_975.bed
[testdata-reb1-bam]:ftp://data1.commons.psu.edu/pub/commons/eberly/pughlab/yeast-epigenome-project/12141_YEP.zip
[saccer3cegr-fasta]:https://github.com/CEGRcode/GenoPipe/blob/master/EpitopeID/utility_scripts/genome_data/download_sacCer3_Genome.sh
[noble2009]:https://journals.plos.org/ploscompbiol/article/file?id=10.1371/journal.pcbi.1000424&type=printable
[github-repo]:https://www.github.com/CEGRcode/scriptmanager
[github-v14]:https://github.com/CEGRcode/scriptmanager/releases/download/v0.14/ScriptManager-v0.14.jar
[ex-chipexo-bash]:https://www.github.com/CEGRcode/scriptmanager

[java-install]:/docs/#java

[bam-indexer]:/docs/bam-manipulation/bam-indexer.md
[expand-bed]:/docs/coordinate-manipulation/expand-bed.md
[tag-pileup]:/docs/read-analysis/tag-pileup.md
[heatmap]:/docs/figure-generation/heatmap.md
[merge-heatmap]:/docs/figure-generation/merge-heatmap.md
[fasta-extract]:/docs/sequence-analysis/fasta-extract.md
[four-color]:/docs/figure-generation/four-color.md
